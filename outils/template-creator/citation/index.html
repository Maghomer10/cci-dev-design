<!doctype html>
<html lang="fr-fr">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

    <title>Template Creator - Citation</title>



    <link rel="stylesheet" href="../../../bootstrap.css">
    <script src="../../../JS/jquery-3.3.1.min.js"></script>
    


    <script src="../@js/jquery-1.11.3-min.js"></script>
    <script src="../@js/EXT-filesaver.js" type="text/javascript"></script>
    <script src="../@js/EXT-canvas-toBlob.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.0.0-rc.3/dist/html2canvas.js" type="text/javascript"></script>  


		<script src="../@js/jquery.sceditor.xhtml.min.js"></script>
		<script src="../@js/jquery.sceditor.fr.js"></script>
		<script src="../@js/jquery.sceditor.plaintext.js"></script>
		<script src="../@js/jquery.sceditor.undo.js"></script>
    

    <link href="../@css/style-outil.css" rel="stylesheet" type="text/css">
    <link href="../@css/sceditor.css" rel="stylesheet" type="text/css">
    <link href="./style.css" rel="stylesheet" type="text/css">



    
    <script type="text/javascript">

  
      function mobileCompatible(){
        var TemplateX = 700;
        var TemplateY = 394;

        var x = document.body.offsetWidth;
        var X = x / TemplateX;
        var scaleX = 'scale(' + X + ')';

        var y = window.innerHeight;
        var Y = (x*TemplateY)/TemplateX;
        var navY = document.getElementById('pills-tab').offsetHeight;
        var ctaY = document.getElementById('telechargement').offsetHeight;
        var margeY = ctaY + navY;
        var calcY = 'calc(' + y + 'px - ' + margeY + 'px - ' + Y + 'px - 3vh)';
        var calcYfixe = 'calc(' + y + 'px - ' + margeY + 'px - ' + TemplateY + 'px - 3vh)';

        $('#screen').each(function(){
                if(x < TemplateX){
                  $(this).style( 'transform', scaleX );
                  $('#outils .tab-content').style( 'max-height', calcY );
                }
                else{
                  $(this).style( 'transform', 'scale(1)' );
                  $('#outils .tab-content').style( 'max-height', calcYfixe );
                }
        });


        return false;
      }
  
      $(document).ready(function(){
          $(document).ready(mobileCompatible);
          $(window).resize(mobileCompatible);
      });
  
      
      var shotit = function() {
          $('#screen').style( 'transform', 'scale(2)' );
          html2canvas(document.getElementById('screen'), 
                    ).then(function(canvas) {
            document.body.appendChild(canvas);
                            canvas.toBlob(function(blob) {
                              saveAs(blob, "template.png"); 
                            });
              });
          $('#screen').style( 'transform', 'scale(1)' );
          $(document).ready(mobileCompatible);
       }
       
  
      </script>

      

</head>

<body>

    




  <div id='affiche'>
 
    
    
    
    <div id="export">
      <section id="screen">
        <img id="fond" src="../@img/grille.png" style="width: 100%;">
          <div id="aremplacer">
            <div id="bandethematique">
              <img id="quote" src="../@img/quote.svg">
              <div id="degrade1"><img src="../@img/degrade.png"></div>
            </div>
            <div id="degrade2"><img src="../@img/degrade.png"></div> 
            <div id="fondbleu">
             <div class="text">
                <div class="texte-principal"><p>1er circuit de vente 
                  de livres en France 
                  avec <strong>40% du marché</strong>, avant les grandes surfaces et internet. </p></div>
                  
                <div class="contient-texte-nom">
                  <p><span class="texte-nom">truc de machin</span> <span class="texte-societe">société de machin</span></p>
                </div>
              </div>
            </div>   
          <div class="image-photo">
              <img src="../@img/image_gallery.jpg" id="cursorImage" ondragstart="return false;" style="transform: scale(1)"/>
          </div> 
          <div class="logo">
            <img src="../@img/pastille.png" id="pastille"/>
            <div id="logotext">
            <p class="CCI-nom">chambre de commerce</p>
            <p class="CCI-nom2">et d'industrie</p>
            </div>
          </div>
          <div class="logopastille">
            <img src="../@img/pastille.png" id="logopastille">
          </div>

   
		  </div>
          
      </section>
    </div>
    
    
    
    
    
<div id="outils">

<nav class="nav nav-fill font-size-2 bg-blanc text-500" role="tablist"  id="pills-tab">
    <a href="#texte" class="nav-link nav-item active" role="tab" aria-controls="texte" data-toggle="pill" id="onglet-texte" aria-selected="true">Texte</a>
    <a href="#image" class="nav-link nav-item" role="tab" aria-controls="image" data-toggle="pill" id="onglet-image" aria-selected="false">Image</a>
    <a href="#logo" class="nav-link nav-item" role="tab" aria-controls="logo" data-toggle="pill" id="onglet-logo" aria-selected="false">Logo</a>
</nav>
    
	
<div class="tab-content" id="pills-tabContent">
  <div class="tab-pane show active py-4 px-3 container" id="texte" role="tabpanel" aria-labelledby="onglet-texte">
    


      <textarea id="Texteprincipal" class="w-100" rows="6" cols="20">Nous sommes pris dans le quotidien de l’entreprise, les recrutements, les contrats… Il est difficile de trouver les bons contacts. <br>La CCI nous a beaucoup aidés.</textarea>
    
<!--
      <div class="input-group-append mt-2">
        <div class="input-group-text">
          <input type="checkbox" id="cesure" aria-label="cesure">
          <span class="ml-2">Césure</span>
        </div>
      </div>
-->

    <div class="input-group input-minus-plus mt-2 mb-2">
      <div class="input-group-prepend input-minus"  onclick="this.parentNode.querySelector('input[type=number]').stepDown()">
        <span class="input-group-text">-</span>
      </div>
      <input  class="form-control"  type="number" id="select-text-size" value="210" step="2">
      <div class="input-group-append input-plus" onclick="this.parentNode.querySelector('input[type=number]').stepUp()">
        <span class="input-group-text" id="basic-addon1">+</span>
      </div>
    </div>
    
      
        <hr>

        
      <div class="input-group mb-2">
        <div class="input-group-prepend">
          <span class="input-group-text">Nom</span>
        </div>
        <input  class="form-control" type="text" id="select-text-nom" value="Aymeric Le Brun">
      </div>

      
      <div class="input-group mb-2">
        <div class="input-group-prepend">
          <span class="input-group-text">Fonction</span>
        </div>
        <input  class="form-control" type="text" id="select-text-societe" value="Dirigeant de CYFAC">
        
        <div class="input-group-append">
          <div class="input-group-text">
            <input type="checkbox" id="sautfonction" aria-label="sautdeligne">
            <span class="ml-2"> Saut de ligne</span>
          </div>
        </div>
      </div>
        
        
        
      <div class="input-group input-minus-plus">
        <div class="input-group-prepend input-minus"  onclick="this.parentNode.querySelector('input[type=number]').stepDown()">
          <span class="input-group-text">-</span>
        </div>
        <input  class="form-control"  type="number" id="select-text-nom-size" value="150">
        <div class="input-group-append input-plus" onclick="this.parentNode.querySelector('input[type=number]').stepUp()">
          <span class="input-group-text" id="basic-addon1">+</span>
        </div>
      </div>
      

        

    </div>
    
    
    
    
  <div class="tab-pane py-4 px-3 container" id="image" role="tabpanel" aria-labelledby="onglet-image">
    

    <div class="input-group">
      <div class="input-group-prepend">
        <label class="input-group-text" for="color">Thématique</label>
      </div>
      <select class="custom-select" id="color">
        <option value="bleu-f1">Classique</option>
        <option value="cyan">Institutionnel</option>
        <option value="turquoise">Numérique</option>
        <option value="vert">Développement durable</option>
        <option value="chartreuse">Formation</option>
        <option value="jaune">International</option>
        <option value="orange">Compétence RH</option>
        <option value="rouge">Compétitivité</option>
        <option value="rose">Développement commercial</option>
        <option value="violet">Création, Reprise, Transmission</option>
        <option value="brun">Financement</option>
      </select>
    </div>

    <hr>

<div class="input-group mb-2">
  <div class="custom-file">
    <input type="file" class="custom-file-input" id="inputFileToLoad" aria-describedby="image-photo">
    <label class="custom-file-label" for="inputGroupFile04">Charger une image</label>
  </div>
</div>

        
        <div class="input-group input-minus-plus">
          <div class="input-group-prepend input-minus"  onclick="this.parentNode.querySelector('input[type=number]').stepDown()">
            <span class="input-group-text">-</span>
          </div>
          <input  class="form-control"  type="number" id="select-image-size" value="1">
          <div class="input-group-append input-plus" onclick="this.parentNode.querySelector('input[type=number]').stepUp()">
            <span class="input-group-text" id="basic-addon1">+</span>
          </div>
        </div>

    
    </div>


    
  <div class="tab-pane py-4 px-3 container " id="logo" role="tabpanel" aria-labelledby="onglet-logo">
    
    <div class="input-group">
      <div class="input-group-prepend">
        <label class="input-group-text" for="color">Type de logo</label>
      </div>
      <select class="custom-select" id="logoRend">
        <option value="logo">Logo</option>
       <option value="pastille">pastille CCI</option>
      </select>
    </div>

    <hr>
    
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text">Nom de la CCI</span>
            </div>
            <input  class="form-control col-8" type="text" id="name-cci" value="Chambre de commerce" >
            <input  class="form-control" type="text" id="name-cci-l2" value="et d'industrie">
          </div>


    </div>


    </div>

    
    
    
    
<a href="#" id="telechargement" onClick="shotit()">Télécharger</a>
	
	
    
</div>

    
    
    
    
    
    
    
    
        

    

    
    
    
    
 
        
    
    
    <script type="text/javascript">
        
        (function($) {    
  if ($.fn.style) {
    return;
  }

  // Escape regex chars with \
  var escape = function(text) {
    return text.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&");
  };

  // For those who need them (< IE 9), add support for CSS functions
  var isStyleFuncSupported = !!CSSStyleDeclaration.prototype.getPropertyValue;
  if (!isStyleFuncSupported) {
    CSSStyleDeclaration.prototype.getPropertyValue = function(a) {
      return this.getAttribute(a);
    };
    CSSStyleDeclaration.prototype.setProperty = function(styleName, value, priority) {
      this.setAttribute(styleName, value);
      var priority = typeof priority != 'undefined' ? priority : '';
      if (priority != '') {
        // Add priority manually
        var rule = new RegExp(escape(styleName) + '\\s*:\\s*' + escape(value) +
            '(\\s*;)?', 'gmi');
        this.cssText =
            this.cssText.replace(rule, styleName + ': ' + value + ' !' + priority + ';');
      }
    };
    CSSStyleDeclaration.prototype.removeProperty = function(a) {
      return this.removeAttribute(a);
    };
    CSSStyleDeclaration.prototype.getPropertyPriority = function(styleName) {
      var rule = new RegExp(escape(styleName) + '\\s*:\\s*[^\\s]*\\s*!important(\\s*;)?',
          'gmi');
      return rule.test(this.cssText) ? 'important' : '';
    }
  }

  // The style function
  $.fn.style = function(styleName, value, priority) {
    // DOM node
    var node = this.get(0);
    // Ensure we have a DOM node
    if (typeof node == 'undefined') {
      return this;
    }
    // CSSStyleDeclaration
    var style = this.get(0).style;
    // Getter/Setter
    if (typeof styleName != 'undefined') {
      if (typeof value != 'undefined') {
        // Set style property
        priority = typeof priority != 'undefined' ? priority : '';
        style.setProperty(styleName, value, priority);
        return this;
      } else {
        // Get style property
        return style.getPropertyValue(styleName);
      }
    } else {
      // Get CSSStyleDeclaration
      return style;
    }
  };
})(jQuery);
        
        
        
			var textarea = document.getElementById('Texteprincipal');
			sceditor.create(textarea, {
				format: 'xhtml',
				toolbar: 'bold|italic',
				style: '../@css/sceditor.css', 
				local: 'fr', 
    		plugins: 'plaintext',
        pastetext: {
            addButton: false,
            enabled: true
        },
				id: 'leTexte', 
        enablePasteFiltering: true
			});
			
			
        
        
        setInterval(function(){

          
				var val = sceditor.instance(textarea).val();
				$('#aremplacer .texte-principal').html( val );
          
          var htmlString = $('#name-cci').val();
          var cciligne2 = $('#name-cci-l2').val();
            $('#aremplacer p.CCI-nom').html( htmlString );
            $('#aremplacer p.CCI-nom2').html(cciligne2);

          var size = $('#logotext').width();
          $('.logo').css('width', size + 28 + 50 + 'px');

          var htmlString = $('#select-titre').val();
            $('#aremplacer p.titre').html( '<span>' + htmlString + '</span>' );

            
            var nommentrepreneur = $('#select-text-nom').val();
            var isChecked = $('#sautfonction').prop('checked');
            if(isChecked === true){
              $('#aremplacer span.texte-nom').html( nommentrepreneur + '<br>');
            }else{
              $('#aremplacer span.texte-nom').html( nommentrepreneur + ',');
            }
            
            var htmlString = $('#select-text-societe').val();
            $('#aremplacer span.texte-societe').html( htmlString );

            var htmlString = $('#select-text-societe-l2').val();
            $('#aremplacer .texte-societe-l2').html( htmlString );
          
            var tfont = $('#select-text-size').val();
            $('#aremplacer .texte-principal').css( 'font-size', tfont + '%' );

            var tfontsize = $('#select-text-nom-size').val();
            $('#aremplacer .contient-texte-nom').css( 'font-size', tfontsize + '%' );
          
            
            var logo = $('#logoRend').val();
            if (logo  === 'logo'){
              $('#aremplacer .logo').css( 'display', 'block' );
              $('#aremplacer .logopastille').css( 'display', 'none' );
            }else{
              $('#aremplacer .logo').css( 'display', 'none' );
              $('#aremplacer .logopastille').css( 'display', 'block' );
            }

            
            var color = $('#color').val();
            var backgrnd = "var(--"+color+")"
            $('#bandethematique').css('background-color',backgrnd); 

            var cesure = $('#cesure').prop('checked');
            if (cesure === true){
              $('#aremplacer .texte-principal p').css( 'hyphens', 'auto' );
            } else {
              $('#aremplacer .texte-principal p').css( 'hyphens', 'none' );
            };


            var imgsize = $('#select-image-size').val();
            var imsizecorrect = ( imgsize / 10 ) + 1;
            var imsizecorrectcss = 'scale(' + imsizecorrect + ')';

            $('#aremplacer .image-photo #cursorImage').css( 'transform', imsizecorrectcss );
            
            encodeImageFileAsURL();
            

			
        }, 200);

        
       /*  setInterval(function(){

        html2canvas(document.getElementById('screen'), 
               ).then(function(canvas) {
      $('.affiche').html(canvas);
        });
        
      }, 1000); */
		
		
    </script>
    
    
    
    
    
    
        
  
    
    
   
    <div id="imgTest"></div>
    
    
    
    <script type="text/javascript">
    
function encodeImageFileAsURL(){

    var filesSelected = document.getElementById("inputFileToLoad").files;
    if (filesSelected.length > 0)
    {
        var fileToLoad = filesSelected[0];
        var fileReader = new FileReader();
        fileReader.onload = function(fileLoadedEvent) {
            var srcData = fileLoadedEvent.target.result;
            var newImage = document.createElement('img');
            var newBG = 'url(' + srcData + ')';
            $('#aremplacer .image-photo #cursorImage').attr( 'src', srcData );
        }
        fileReader.readAsDataURL(fileToLoad);
    }
}

    </script>
    
    
    
    
    
    <script type="text/javascript">
        
    let gMouseDownX = 0;
let gMouseDownY = 0;
let gMouseDownOffsetX = 0;
let gMouseDownOffsetY = 0;

function addListeners() {
    document.getElementById('cursorImage').addEventListener('mousedown', mouseDown, false);
    window.addEventListener('mouseup', mouseUp, false);
}

function mouseUp() {
    window.removeEventListener('mousemove', divMove, true);
}

function mouseDown(e) {
    gMouseDownX = e.clientX;
    gMouseDownY = e.clientY;

    var div = document.getElementById('cursorImage');

    //The following block gets the X offset (the difference between where it starts and where it was clicked)
    let leftPart = "";
    if(!div.style.left)
        leftPart+="0px";    //In case this was not defined as 0px explicitly.
    else
        leftPart = div.style.left;
    let leftPos = leftPart.indexOf("px");
    let leftNumString = leftPart.slice(0, leftPos); // Get the X value of the object.
    gMouseDownOffsetX = gMouseDownX - parseInt(leftNumString,10);

    //The following block gets the Y offset (the difference between where it starts and where it was clicked)
    let topPart = "";
    if(!div.style.top)
        topPart+="0px";     //In case this was not defined as 0px explicitly.
    else
        topPart = div.style.top;
    let topPos = topPart.indexOf("px");
    let topNumString = topPart.slice(0, topPos);    // Get the Y value of the object.
    gMouseDownOffsetY = gMouseDownY - parseInt(topNumString,10);

    window.addEventListener('mousemove', divMove, true);
}

function divMove(e){
    var div = document.getElementById('cursorImage');
    div.style.position = 'absolute';
    let topAmount = e.clientY - gMouseDownOffsetY;
    div.style.top = topAmount + 'px';
    let leftAmount = e.clientX - gMouseDownOffsetX;
    div.style.left = leftAmount + 'px';
}

addListeners();
    
    </script>
    
    
    
    
    
    
    
    
    


            
	
    <script src="../../../JS/charteCCI.js"></script>

    <script src="../../../JS/popper.min.js"></script>
    <script src="../../../JS/bootstrap.min.js"></script>

    <script src="../../../JS/min-ie11CustomProperties.js"></script>	
    
    

    <script src="https://cdn.jsdelivr.net/npm/ie11-custom-properties/ie11CustomProperties.min.js" type="text/javascript"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    
    

    
    
    
  </div>


  </body>

</html>
